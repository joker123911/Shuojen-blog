<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æŠ•è³‡å ±é…¬è©¦ç®—è¡¨</title>
<style>
    /* å®Œå…¨å°é½Š Food App çš„ç´«è‰²ç³»ç¾ä»£é¢¨æ ¼ */
    :root {
        --primary-purple: #6366f1; /* æ“·å–è‡ªåœ–ç‰‡çš„ç´«è‰²æŒ‰éˆ• */
        --bg-color: #f8fafc;
        --card-bg: #ffffff;
        --text-main: #1e293b;
        --text-muted: #64748b;
        --border-color: #f1f5f9;
        --radius-lg: 24px; /* æ›´å¤§çš„åœ“è§’ */
        --radius-md: 12px;
        --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02);
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-main);
        display: flex;
        justify-content: center;
        padding: 40px 20px;
        margin: 0;
    }

    .calculator-container {
        width: 100%;
        max-width: 600px;
        background-color: var(--card-bg);
        padding: 40px;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
    }

    h2 {
        text-align: center;
        color: var(--text-main);
        font-size: 24px;
        font-weight: 800;
        margin-bottom: 8px;
    }

    .subtitle {
        text-align: center;
        color: var(--text-muted);
        font-size: 14px;
        margin-bottom: 30px;
    }

    .input-group {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        margin-bottom: 24px;
    }

    .input-field {
        display: flex;
        flex-direction: column;
    }

    .input-field label {
        margin-bottom: 6px;
        color: var(--text-main);
        font-size: 14px;
        font-weight: 600;
    }

    .input-field input {
        padding: 12px 16px;
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        font-size: 16px;
        background-color: #fcfcfc;
        transition: all 0.2s;
    }

    .input-field input:focus {
        outline: none;
        border-color: var(--primary-purple);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .unit-info {
        font-size: 12px;
        color: var(--text-muted);
        text-align: right;
        margin-bottom: 12px;
    }

    /* æ“²éª°å­æ±ºå®šé¢¨æ ¼çš„æŒ‰éˆ• */
    .calculate-btn {
        display: block;
        width: 100%;
        padding: 16px;
        background-color: var(--primary-purple);
        color: white;
        border: none;
        border-radius: var(--radius-md);
        font-size: 18px;
        font-weight: 700;
        cursor: pointer;
        transition: transform 0.1s, background-color 0.2s;
        margin-bottom: 20px;
    }

    .calculate-btn:hover {
        background-color: #4f46e5;
    }

    .calculate-btn:active {
        transform: scale(0.98);
    }

    /* è¡¨æ ¼è¨­è¨ˆ */
    .table-wrapper {
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        overflow: hidden;
    }

    .results-table {
        width: 100%;
        border-collapse: collapse;
    }

    .results-table th {
        background-color: #f8fafc;
        color: var(--text-muted);
        font-size: 13px;
        font-weight: 600;
        padding: 12px;
        text-align: center;
        border-bottom: 1px solid var(--border-color);
    }

    .results-table td {
        padding: 8px;
        border-bottom: 1px solid var(--border-color);
        text-align: center;
    }

    .results-table input {
        width: 80%;
        padding: 6px;
        border: 1px solid transparent;
        border-radius: 4px;
        text-align: center;
        font-size: 14px;
        background-color: transparent;
    }

    .results-table input:hover {
        background-color: #f1f5f9;
    }

    .results-table input:focus {
        outline: none;
        background-color: #fff;
        border-color: var(--border-color);
    }

    #error-message {
        color: #ef4444;
        text-align: center;
        font-size: 14px;
        margin-top: 10px;
        display: none;
    }

    .footer-note {
        text-align: center;
        font-size: 12px;
        color: var(--text-muted);
        margin-top: 20px;
    }
</style>
</head>
<body>

<div class="calculator-container">
    <h2>ğŸ“ˆ è¤‡åˆ©è©¦ç®—è¡¨</h2>
    <div class="subtitle">Shuojen.site æŠ•è³‡å·¥å…·</div>

    <div class="input-group">
        <div class="input-field">
            <label for="startAge">èµ·å§‹å¹´é½¡</label>
            <input type="number" id="startAge" value="27">
        </div>
        <div class="input-field">
            <label for="endAge">çµæŸå¹´é½¡</label>
            <input type="number" id="endAge" value="67">
        </div>
        <div class="input-field">
            <label for="annualSavings">æ¯å¹´å­˜å…¥é‡‘é¡</label>
            <input type="number" id="annualSavings" value="12">
        </div>
        <div class="input-field">
            <label for="rateOfReturn">å¹´å ±é…¬ç‡ (%)</label>
            <input type="number" id="rateOfReturn" value="5">
        </div>
    </div>
    <div class="unit-info">é‡‘é¡å–®ä½ï¼šè¬å…ƒ</div>

    <button class="calculate-btn" onclick="generateInitialTable()">ç”¢ç”Ÿ / é‡è¨­è¡¨æ ¼</button>
    <p id="error-message"></p>

    <div class="table-wrapper">
        <table class="results-table">
            <thead>
                <tr>
                    <th>å¹´é½¡</th>
                    <th>å¹´å­˜</th>
                    <th>å ±é…¬</th>
                    <th>ç¸½é‡‘é¡</th>
                </tr>
            </thead>
            <tbody id="results-body">
            </tbody>
        </table>
    </div>

    <div class="footer-note">Â© Shuojen-blog Financial Tool</div>
</div>

<script>
    /* æ ¸å¿ƒé‚è¼¯å®Œå…¨ä¿ç•™ä¸è®Š */
    document.addEventListener('DOMContentLoaded', generateInitialTable);

    function generateInitialTable() {
        const startAge = parseInt(document.getElementById('startAge').value);
        const endAge = parseInt(document.getElementById('endAge').value);
        const annualSavings = parseFloat(document.getElementById('annualSavings').value);
        const resultsBody = document.getElementById('results-body');
        const errorMessage = document.getElementById('error-message');
        resultsBody.innerHTML = '';
        errorMessage.style.display = 'none';

        if (isNaN(startAge) || isNaN(endAge) || isNaN(annualSavings) || startAge >= endAge) {
            errorMessage.textContent = 'è«‹è¼¸å…¥æœ‰æ•ˆæ•¸å­—ï¼Œèµ·å§‹å¹´é½¡é ˆå°æ–¼çµæŸå¹´é½¡ã€‚';
            errorMessage.style.display = 'block';
            return;
        }

        for (let age = startAge; age <= endAge; age++) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${age}</td>
                <td><input type="number" id="savings-${age}" value="${annualSavings.toFixed(1)}" step="0.1" onchange="handleSavingsChange(${age})"></td>
                <td id="return-${age}" style="color: #10b981; font-weight: 600;">0.0</td>
                <td><input type="number" id="total-${age}" value="0.0" data-full-value="0.0" step="0.1" onchange="handleTotalChange(${age})" style="font-weight: 600;"></td>
            `;
            resultsBody.appendChild(row);
        }
        updateFromRow(startAge);
    }

    function handleSavingsChange(age) {
        updateFromRow(age);
    }

    function handleTotalChange(age) {
        const endAge = parseInt(document.getElementById('endAge').value);
        const changedTotalInput = document.getElementById(`total-${age}`);
        changedTotalInput.dataset.fullValue = parseFloat(changedTotalInput.value);

        if (age < endAge) {
            updateFromRow(age + 1);
        }
    }

    function updateFromRow(startUpdateAge) {
        const startAge = parseInt(document.getElementById('startAge').value);
        const endAge = parseInt(document.getElementById('endAge').value);
        const rateOfReturn = parseFloat(document.getElementById('rateOfReturn').value) / 100;

        for (let age = startUpdateAge; age <= endAge; age++) {
            const prevTotalElement = document.getElementById(`total-${age - 1}`);
            const previousTotal = (age === startAge) ? 0 : parseFloat(prevTotalElement.dataset.fullValue || prevTotalElement.value);

            const currentSavings = parseFloat(document.getElementById(`savings-${age}`).value);
            const currentReturn = previousTotal * rateOfReturn;
            const newTotal = previousTotal + currentReturn + currentSavings;

            const totalInput = document.getElementById(`total-${age}`);
            document.getElementById(`return-${age}`).textContent = currentReturn.toFixed(1);

            totalInput.value = newTotal.toFixed(1);
            totalInput.dataset.fullValue = newTotal.toFixed(5);
        }
    }
</script>

</body>
</html>